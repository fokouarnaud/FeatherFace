# FeatherFace Weight Files Clarification

## Weight Files Explanation

### 1. Pre-trained Backbone Weights
**File**: `mobilenetV1X0.25_pretrain.tar`
- **Purpose**: Pre-trained MobileNetV1 0.25x backbone weights
- **Usage**: Initialize backbone during training
- **Source**: ImageNet pre-training
- **Required for**: Both V1 and V2 training

### 2. Trained FeatherFace V1 Model
**File**: `mobilenet0.25_Final.pth`
- **Purpose**: Complete trained FeatherFace model (V1)
- **Contains**: All weights (backbone + SSH + BiFPN + CBAM + heads)
- **Usage**: 
  - As teacher model for V2 knowledge distillation
  - For V1 inference
- **Generated by**: Running `train.py` for 350 epochs

### 3. FeatherFace V2 Model
**File**: `weights/v2/FeatherFaceV2_final.pth`
- **Purpose**: Optimized FeatherFace V2 model
- **Parameters**: 0.256M (vs 0.592M in V1)
- **Generated by**: Running `train_v2.py` with knowledge distillation

## Common Confusion

### ❌ Incorrect
```python
# Wrong - FeatherNetB_se.pth is NOT FeatherFace
--teacher_model ./weights/FeatherNetB_se.pth
```

### ✅ Correct
```python
# Right - Use the trained FeatherFace V1 model
--teacher_model ./weights/mobilenet0.25_Final.pth
```

## Training Workflow

1. **Train V1 (Teacher)**
   ```bash
   python train.py
   # Generates: mobilenet0.25_Final.pth
   ```

2. **Train V2 (Student) with Knowledge Distillation**
   ```bash
   python train_v2.py --teacher_model ./weights/mobilenet0.25_Final.pth
   # Uses V1 as teacher to train V2
   ```

## File Naming Convention

- `mobilenet0.25_*`: FeatherFace models (using MobileNet 0.25x backbone)
- `mobilenetV1X0.25_*`: Pure MobileNet backbone weights
- `FeatherFaceV2_*`: V2 optimized models

## Quick Check

To verify your teacher model:
```python
import torch

# Load and check
checkpoint = torch.load('./weights/mobilenet0.25_Final.pth')
if 'state_dict' in checkpoint:
    print("Valid FeatherFace V1 model")
    param_count = sum(p.numel() for p in checkpoint['state_dict'].values())
    print(f"Parameters: {param_count:,} ({param_count/1e6:.3f}M)")
    # Should show ~592K parameters
```

## Summary

- **Teacher Model**: `mobilenet0.25_Final.pth` (FeatherFace V1)
- **NOT**: `FeatherNetB_se.pth` (different architecture)
- **Student Model**: FeatherFace V2 (0.256M params)
- **Method**: Knowledge Distillation from V1 to V2