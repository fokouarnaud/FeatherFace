<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: FeatherFaceV2Architecture Pages: 1 -->
<svg width="1732pt" height="718pt"
 viewBox="0.00 0.00 1732.41 718.07" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 714.07)">
<title>FeatherFaceV2Architecture</title>
<polygon fill="#f8f9fa" stroke="transparent" points="-4,4 -4,-714.07 1728.41,-714.07 1728.41,4 -4,4"/>
<g id="clust1" class="cluster">
<title>cluster_main</title>
<path fill="#f8f9fa" stroke="#bdc3c7" d="M294,-559.07C294,-559.07 1704.41,-559.07 1704.41,-559.07 1710.41,-559.07 1716.41,-565.07 1716.41,-571.07 1716.41,-571.07 1716.41,-690.07 1716.41,-690.07 1716.41,-696.07 1710.41,-702.07 1704.41,-702.07 1704.41,-702.07 294,-702.07 294,-702.07 288,-702.07 282,-696.07 282,-690.07 282,-690.07 282,-571.07 282,-571.07 282,-565.07 288,-559.07 294,-559.07"/>
<text text-anchor="middle" x="999.2" y="-686.87" font-family="Arial" font-size="14.00" fill="#34495e">(a) FeatherFace V2 Architecture</text>
</g>
<g id="clust2" class="cluster">
<title>cluster_fpn</title>
<polygon fill="#f8f9fa" stroke="#27ae60" stroke-dasharray="5,2" points="714.14,-574.07 714.14,-671.07 1064.72,-671.07 1064.72,-574.07 714.14,-574.07"/>
<text text-anchor="middle" x="889.43" y="-658.27" font-family="Arial" font-size="11.00" fill="#34495e">BiFPN Multi&#45;scale Features</text>
</g>
<g id="clust3" class="cluster">
<title>cluster_coord_attn</title>
<path fill="#f8f9fa" stroke="#e67e22" d="M93.5,-71.07C93.5,-71.07 1445.91,-71.07 1445.91,-71.07 1451.91,-71.07 1457.91,-77.07 1457.91,-83.07 1457.91,-83.07 1457.91,-246.07 1457.91,-246.07 1457.91,-252.07 1451.91,-258.07 1445.91,-258.07 1445.91,-258.07 93.5,-258.07 93.5,-258.07 87.5,-258.07 81.5,-252.07 81.5,-246.07 81.5,-246.07 81.5,-83.07 81.5,-83.07 81.5,-77.07 87.5,-71.07 93.5,-71.07"/>
<text text-anchor="middle" x="769.7" y="-242.87" font-family="Arial" font-size="14.00" fill="#e67e22">(b) Coordinate Attention Mechanism</text>
</g>
<g id="clust4" class="cluster">
<title>cluster_factorization</title>
<polygon fill="#f8f9fa" stroke="#3498db" stroke-dasharray="5,2" points="284.97,-79.07 284.97,-217.07 474.5,-217.07 474.5,-79.07 284.97,-79.07"/>
<text text-anchor="middle" x="379.74" y="-204.27" font-family="Arial" font-size="11.00" fill="#e67e22">Spatial Factorization</text>
</g>
<g id="clust5" class="cluster">
<title>cluster_attention</title>
<polygon fill="#f8f9fa" stroke="#9b59b6" stroke-dasharray="5,2" points="714.14,-82.07 714.14,-208.07 1064.72,-208.07 1064.72,-82.07 714.14,-82.07"/>
<text text-anchor="middle" x="889.43" y="-195.27" font-family="Arial" font-size="11.00" fill="#e67e22">Directional Attention</text>
</g>
<g id="clust6" class="cluster">
<title>cluster_detection</title>
<path fill="#f8f9fa" stroke="#1abc9c" d="M98.5,-288.07C98.5,-288.07 1063.72,-288.07 1063.72,-288.07 1069.72,-288.07 1075.72,-294.07 1075.72,-300.07 1075.72,-300.07 1075.72,-495.07 1075.72,-495.07 1075.72,-501.07 1069.72,-507.07 1063.72,-507.07 1063.72,-507.07 98.5,-507.07 98.5,-507.07 92.5,-507.07 86.5,-501.07 86.5,-495.07 86.5,-495.07 86.5,-300.07 86.5,-300.07 86.5,-294.07 92.5,-288.07 98.5,-288.07"/>
<text text-anchor="middle" x="581.11" y="-491.87" font-family="Arial" font-size="14.00" fill="#1abc9c">(c) Detection Head (SSH)</text>
</g>
<g id="clust7" class="cluster">
<title>cluster_context</title>
<polygon fill="#f8f9fa" stroke="#e74c3c" stroke-dasharray="5,2" points="290.5,-296.07 290.5,-476.07 617.53,-476.07 617.53,-296.07 290.5,-296.07"/>
<text text-anchor="middle" x="454.02" y="-463.27" font-family="Arial" font-size="11.00" fill="#1abc9c">Context Enhancement</text>
</g>
<g id="clust8" class="cluster">
<title>cluster_shuffle</title>
<polygon fill="#f8f9fa" stroke="#16a085" stroke-dasharray="5,2" points="703.66,-296.07 703.66,-476.07 944.93,-476.07 944.93,-296.07 703.66,-296.07"/>
<text text-anchor="middle" x="824.29" y="-463.27" font-family="Arial" font-size="11.00" fill="#1abc9c">Channel Shuffle</text>
</g>
<!-- title -->
<g id="node1" class="node">
<title>title</title>
<polygon fill="lightgrey" stroke="transparent" points="253,-658.07 0,-658.07 0,-614.07 253,-614.07 253,-658.07"/>
<text text-anchor="middle" x="126.5" y="-641.27" font-family="Arial" font-size="16.00" fill="#2c3e50">FeatherFace V2 Architecture</text>
<text text-anchor="middle" x="126.5" y="-623.27" font-family="Arial" font-size="16.00" fill="#2c3e50">(Coordinate Attention Innovation)</text>
</g>
<!-- input -->
<g id="node2" class="node">
<title>input</title>
<polygon fill="#ecf0f1" stroke="#95a5a6" points="361,-654.07 290,-654.07 290,-618.07 361,-618.07 361,-654.07"/>
<text text-anchor="middle" x="325.5" y="-639.07" font-family="Arial" font-size="10.00">Input</text>
<text text-anchor="middle" x="325.5" y="-628.07" font-family="Arial" font-size="10.00">(640×640×3)</text>
</g>
<!-- title&#45;&gt;input -->
<!-- backbone -->
<g id="node3" class="node">
<title>backbone</title>
<polygon fill="#3498db" stroke="black" points="481,-654.07 398,-654.07 398,-618.07 481,-618.07 481,-654.07"/>
<text text-anchor="middle" x="439.5" y="-639.07" font-family="Arial" font-size="10.00" fill="white">MobileNet&#45;0.25</text>
<text text-anchor="middle" x="439.5" y="-628.07" font-family="Arial" font-size="10.00" fill="white">Backbone</text>
</g>
<!-- input&#45;&gt;backbone -->
<g id="edge5" class="edge">
<title>input&#45;&gt;backbone</title>
<path fill="none" stroke="black" d="M361.02,-636.07C369.42,-636.07 378.59,-636.07 387.58,-636.07"/>
<polygon fill="black" stroke="black" points="387.61,-639.57 397.61,-636.07 387.61,-632.57 387.61,-639.57"/>
</g>
<!-- cbam_before -->
<g id="node4" class="node">
<title>cbam_before</title>
<ellipse fill="#e74c3c" stroke="black" cx="574.57" cy="-636.07" rx="56.64" ry="21.43"/>
<text text-anchor="middle" x="574.57" y="-639.07" font-family="Arial" font-size="10.00" fill="white">CBAM</text>
<text text-anchor="middle" x="574.57" y="-628.07" font-family="Arial" font-size="10.00" fill="white">(V1 Conservé)</text>
</g>
<!-- backbone&#45;&gt;cbam_before -->
<g id="edge6" class="edge">
<title>backbone&#45;&gt;cbam_before</title>
<path fill="none" stroke="black" d="M481.15,-636.07C489.59,-636.07 498.69,-636.07 507.77,-636.07"/>
<polygon fill="black" stroke="black" points="507.98,-639.57 517.98,-636.07 507.98,-632.57 507.98,-639.57"/>
</g>
<!-- p3 -->
<g id="node5" class="node">
<title>p3</title>
<polygon fill="#e74c3c" stroke="black" points="776.14,-624.07 722.14,-624.07 722.14,-588.07 776.14,-588.07 776.14,-624.07"/>
<text text-anchor="middle" x="749.14" y="-603.57" font-family="Arial" font-size="10.00" fill="white">P3/8</text>
</g>
<!-- cbam_before&#45;&gt;p3 -->
<g id="edge7" class="edge">
<title>cbam_before&#45;&gt;p3</title>
<path fill="none" stroke="black" d="M626.41,-627.23C653.9,-622.45 687.2,-616.67 712.02,-612.35"/>
<polygon fill="black" stroke="black" points="712.84,-615.76 722.09,-610.6 711.64,-608.86 712.84,-615.76"/>
</g>
<!-- p4 -->
<g id="node6" class="node">
<title>p4</title>
<polygon fill="#f39c12" stroke="black" points="934.43,-633.07 880.43,-633.07 880.43,-597.07 934.43,-597.07 934.43,-633.07"/>
<text text-anchor="middle" x="907.43" y="-612.57" font-family="Arial" font-size="10.00" fill="white">P4/16</text>
</g>
<!-- cbam_before&#45;&gt;p4 -->
<g id="edge8" class="edge">
<title>cbam_before&#45;&gt;p4</title>
<path fill="none" stroke="black" d="M630.83,-638.56C681.13,-640.08 757.36,-640.5 823.14,-633.07 838.75,-631.31 855.75,-627.91 870.29,-624.54"/>
<polygon fill="black" stroke="black" points="871.49,-627.85 880.39,-622.11 869.85,-621.04 871.49,-627.85"/>
</g>
<!-- p5 -->
<g id="node7" class="node">
<title>p5</title>
<polygon fill="#9b59b6" stroke="black" points="1056.72,-643.07 1002.72,-643.07 1002.72,-607.07 1056.72,-607.07 1056.72,-643.07"/>
<text text-anchor="middle" x="1029.72" y="-622.57" font-family="Arial" font-size="10.00" fill="white">P5/32</text>
</g>
<!-- cbam_before&#45;&gt;p5 -->
<g id="edge9" class="edge">
<title>cbam_before&#45;&gt;p5</title>
<path fill="none" stroke="black" d="M628.56,-642.53C635.47,-643.17 642.47,-643.71 649.14,-644.07 652.69,-644.26 653.58,-644.08 657.14,-644.07 787.62,-643.63 821.03,-656.49 950.72,-642.07 964.52,-640.54 979.47,-637.6 992.55,-634.59"/>
<polygon fill="black" stroke="black" points="993.68,-637.92 1002.59,-632.19 992.05,-631.11 993.68,-637.92"/>
</g>
<!-- note2 -->
<g id="node39" class="node">
<title>note2</title>
<polygon fill="#d4edda" stroke="#155724" points="817.14,-551.07 675.14,-551.07 675.14,-515.07 823.14,-515.07 823.14,-545.07 817.14,-551.07"/>
<polyline fill="none" stroke="#155724" points="817.14,-551.07 817.14,-545.07 "/>
<polyline fill="none" stroke="#155724" points="823.14,-545.07 817.14,-545.07 "/>
<text text-anchor="middle" x="749.14" y="-536.07" font-family="Arial" font-size="10.00" fill="#155724">CBAM conservé avant BiFPN</text>
<text text-anchor="middle" x="749.14" y="-525.07" font-family="Arial" font-size="10.00" fill="#155724">(proven baseline V1)</text>
</g>
<!-- cbam_before&#45;&gt;note2 -->
<g id="edge49" class="edge">
<title>cbam_before&#45;&gt;note2</title>
<path fill="none" stroke="#155724" stroke-dasharray="5,2" d="M602.08,-617.28C621.84,-603.58 649.69,-584.89 675.14,-570.07 683.52,-565.19 692.63,-560.28 701.47,-555.7"/>
<polygon fill="#155724" stroke="#155724" points="703.24,-558.73 710.55,-551.07 700.05,-552.5 703.24,-558.73"/>
</g>
<!-- p3&#45;&gt;p4 -->
<g id="edge1" class="edge">
<title>p3&#45;&gt;p4</title>
<path fill="none" stroke="#27ae60" d="M776.29,-602.38C795.63,-600.21 822.59,-598.37 846.14,-601.07 854.09,-601.98 862.53,-603.55 870.49,-605.31"/>
<polygon fill="#27ae60" stroke="#27ae60" points="869.71,-608.73 880.24,-607.62 871.31,-601.91 869.71,-608.73"/>
<text text-anchor="middle" x="843.64" y="-603.87" font-family="Arial" font-size="9.00">↓</text>
</g>
<!-- coord_attn -->
<g id="node8" class="node">
<title>coord_attn</title>
<ellipse fill="#e67e22" stroke="black" stroke-width="2" cx="1201.06" cy="-596.07" rx="58.88" ry="28.98"/>
<text text-anchor="middle" x="1201.06" y="-604.57" font-family="Arial" font-size="10.00" fill="white">Coordinate</text>
<text text-anchor="middle" x="1201.06" y="-593.57" font-family="Arial" font-size="10.00" fill="white">Attention</text>
<text text-anchor="middle" x="1201.06" y="-582.57" font-family="Arial" font-size="10.00" fill="white">(V2 Innovation)</text>
</g>
<!-- p3&#45;&gt;coord_attn -->
<g id="edge10" class="edge">
<title>p3&#45;&gt;coord_attn</title>
<path fill="none" stroke="black" d="M776.28,-600.93C799.3,-596.64 833.8,-590.81 864.14,-588.07 962.67,-579.17 987.9,-580.29 1086.72,-585.07 1101.94,-585.81 1118.28,-587.1 1133.68,-588.54"/>
<polygon fill="black" stroke="black" points="1133.35,-592.03 1143.64,-589.51 1134.03,-585.06 1133.35,-592.03"/>
</g>
<!-- p4&#45;&gt;p3 -->
<g id="edge4" class="edge">
<title>p4&#45;&gt;p3</title>
<path fill="none" stroke="#27ae60" d="M880.18,-613.56C854.46,-612.08 815.04,-609.81 786.34,-608.16"/>
<polygon fill="#27ae60" stroke="#27ae60" points="786.48,-604.66 776.3,-607.58 786.08,-611.65 786.48,-604.66"/>
<text text-anchor="middle" x="843.64" y="-613.87" font-family="Arial" font-size="9.00">↑</text>
</g>
<!-- p4&#45;&gt;p5 -->
<g id="edge2" class="edge">
<title>p4&#45;&gt;p5</title>
<path fill="none" stroke="#27ae60" d="M934.46,-604.44C946.42,-600.85 960.78,-598.37 973.72,-601.07 980.14,-602.41 986.74,-604.55 993.03,-607"/>
<polygon fill="#27ae60" stroke="#27ae60" points="992.02,-610.38 1002.59,-611.06 994.75,-603.93 992.02,-610.38"/>
<text text-anchor="middle" x="971.22" y="-603.87" font-family="Arial" font-size="9.00">↓</text>
</g>
<!-- p4&#45;&gt;coord_attn -->
<g id="edge11" class="edge">
<title>p4&#45;&gt;coord_attn</title>
<path fill="none" stroke="black" d="M934.72,-604.87C945.14,-601.33 957.33,-597.82 968.72,-596.07 1023.52,-587.64 1086.5,-588.3 1132.89,-590.7"/>
<polygon fill="black" stroke="black" points="1132.95,-594.21 1143.13,-591.27 1133.34,-587.22 1132.95,-594.21"/>
</g>
<!-- p5&#45;&gt;p4 -->
<g id="edge3" class="edge">
<title>p5&#45;&gt;p4</title>
<path fill="none" stroke="#27ae60" d="M1002.67,-622.91C985.73,-621.5 963.41,-619.64 944.75,-618.09"/>
<polygon fill="#27ae60" stroke="#27ae60" points="944.78,-614.58 934.53,-617.24 944.2,-621.56 944.78,-614.58"/>
<text text-anchor="middle" x="971.22" y="-622.87" font-family="Arial" font-size="9.00">↑</text>
</g>
<!-- p5&#45;&gt;coord_attn -->
<g id="edge12" class="edge">
<title>p5&#45;&gt;coord_attn</title>
<path fill="none" stroke="black" d="M1056.81,-620.6C1077.71,-617.02 1107.96,-611.84 1135.28,-607.16"/>
<polygon fill="black" stroke="black" points="1135.93,-610.61 1145.2,-605.47 1134.75,-603.71 1135.93,-610.61"/>
</g>
<!-- det_head -->
<g id="node9" class="node">
<title>det_head</title>
<polygon fill="#1abc9c" stroke="black" points="1462.41,-614.07 1377.41,-614.07 1377.41,-578.07 1462.41,-578.07 1462.41,-614.07"/>
<text text-anchor="middle" x="1419.91" y="-599.07" font-family="Arial" font-size="10.00" fill="white">Detection Head</text>
<text text-anchor="middle" x="1419.91" y="-588.07" font-family="Arial" font-size="10.00" fill="white">(SSH)</text>
</g>
<!-- coord_attn&#45;&gt;det_head -->
<g id="edge13" class="edge">
<title>coord_attn&#45;&gt;det_head</title>
<path fill="none" stroke="black" d="M1259.89,-596.07C1293.29,-596.07 1334.94,-596.07 1367.24,-596.07"/>
<polygon fill="black" stroke="black" points="1367.37,-599.57 1377.37,-596.07 1367.37,-592.57 1367.37,-599.57"/>
</g>
<!-- feat_input -->
<g id="node11" class="node">
<title>feat_input</title>
<polygon fill="#ecf0f1" stroke="#95a5a6" points="163.5,-186.07 89.5,-186.07 89.5,-150.07 163.5,-150.07 163.5,-186.07"/>
<text text-anchor="middle" x="126.5" y="-171.07" font-family="Arial" font-size="10.00">Input Feature</text>
<text text-anchor="middle" x="126.5" y="-160.07" font-family="Arial" font-size="10.00">[H, W, C]</text>
</g>
<!-- coord_attn&#45;&gt;feat_input -->
<!-- note1 -->
<g id="node38" class="node">
<title>note1</title>
<polygon fill="#fff3cd" stroke="#856404" points="1499.41,-551.07 1334.41,-551.07 1334.41,-515.07 1505.41,-515.07 1505.41,-545.07 1499.41,-551.07"/>
<polyline fill="none" stroke="#856404" points="1499.41,-551.07 1499.41,-545.07 "/>
<polyline fill="none" stroke="#856404" points="1505.41,-545.07 1499.41,-545.07 "/>
<text text-anchor="middle" x="1419.91" y="-536.07" font-family="Arial" font-size="10.00" fill="#856404">Innovation V2: Coordinate Attention</text>
<text text-anchor="middle" x="1419.91" y="-525.07" font-family="Arial" font-size="10.00" fill="#856404">remplace CBAM après BiFPN</text>
</g>
<!-- coord_attn&#45;&gt;note1 -->
<g id="edge48" class="edge">
<title>coord_attn&#45;&gt;note1</title>
<path fill="none" stroke="#856404" stroke-dasharray="5,2" d="M1250.62,-580.45C1275.58,-572.56 1306.53,-563.01 1334.41,-555.07 1335.87,-554.66 1337.34,-554.24 1338.83,-553.82"/>
<polygon fill="#856404" stroke="#856404" points="1340.05,-557.11 1348.76,-551.07 1338.18,-550.37 1340.05,-557.11"/>
</g>
<!-- outputs -->
<g id="node10" class="node">
<title>outputs</title>
<polygon fill="#34495e" stroke="black" points="1708.41,-614.07 1542.41,-614.07 1542.41,-578.07 1708.41,-578.07 1708.41,-614.07"/>
<text text-anchor="middle" x="1625.41" y="-599.07" font-family="Arial" font-size="10.00" fill="white">Detection Outputs</text>
<text text-anchor="middle" x="1625.41" y="-588.07" font-family="Arial" font-size="10.00" fill="white">[BBox, Classification, Landmarks]</text>
</g>
<!-- det_head&#45;&gt;outputs -->
<g id="edge14" class="edge">
<title>det_head&#45;&gt;outputs</title>
<path fill="none" stroke="black" d="M1462.58,-596.07C1482.63,-596.07 1507.52,-596.07 1531.72,-596.07"/>
<polygon fill="black" stroke="black" points="1532.03,-599.57 1542.03,-596.07 1532.03,-592.57 1532.03,-599.57"/>
</g>
<!-- det_input -->
<g id="node25" class="node">
<title>det_input</title>
<polygon fill="#ecf0f1" stroke="#95a5a6" points="158.5,-394.07 94.5,-394.07 94.5,-358.07 158.5,-358.07 158.5,-394.07"/>
<text text-anchor="middle" x="126.5" y="-379.07" font-family="Arial" font-size="10.00">Multi&#45;scale</text>
<text text-anchor="middle" x="126.5" y="-368.07" font-family="Arial" font-size="10.00">Features</text>
</g>
<!-- det_head&#45;&gt;det_input -->
<!-- pool_h -->
<g id="node12" class="node">
<title>pool_h</title>
<ellipse fill="#3498db" stroke="black" cx="325.5" cy="-108.07" rx="32.55" ry="21.43"/>
<text text-anchor="middle" x="325.5" y="-111.07" font-family="Arial" font-size="10.00" fill="white">X&#45;Pool</text>
<text text-anchor="middle" x="325.5" y="-100.07" font-family="Arial" font-size="10.00" fill="white">(H×1)</text>
</g>
<!-- feat_input&#45;&gt;pool_h -->
<g id="edge15" class="edge">
<title>feat_input&#45;&gt;pool_h</title>
<path fill="none" stroke="black" d="M163.63,-157.07C198.21,-146.54 250.2,-130.7 285.65,-119.9"/>
<polygon fill="black" stroke="black" points="287.09,-123.12 295.64,-116.86 285.05,-116.43 287.09,-123.12"/>
</g>
<!-- pool_w -->
<g id="node13" class="node">
<title>pool_w</title>
<ellipse fill="#3498db" stroke="black" cx="325.5" cy="-168.07" rx="31.64" ry="21.43"/>
<text text-anchor="middle" x="325.5" y="-171.07" font-family="Arial" font-size="10.00" fill="white">Y&#45;Pool</text>
<text text-anchor="middle" x="325.5" y="-160.07" font-family="Arial" font-size="10.00" fill="white">(1×W)</text>
</g>
<!-- feat_input&#45;&gt;pool_w -->
<g id="edge16" class="edge">
<title>feat_input&#45;&gt;pool_w</title>
<path fill="none" stroke="black" d="M163.63,-168.07C197.5,-168.07 248.08,-168.07 283.46,-168.07"/>
<polygon fill="black" stroke="black" points="283.46,-171.57 293.46,-168.07 283.46,-164.57 283.46,-171.57"/>
</g>
<!-- fusion -->
<g id="node23" class="node">
<title>fusion</title>
<polygon fill="#f39c12" stroke="black" points="1297.26,-162.07 1249.16,-186.56 1152.97,-186.56 1104.87,-162.07 1152.97,-137.58 1249.16,-137.58 1297.26,-162.07"/>
<text text-anchor="middle" x="1201.06" y="-165.07" font-family="Arial" font-size="10.00" fill="white">Fusion</text>
<text text-anchor="middle" x="1201.06" y="-154.07" font-family="Arial" font-size="10.00" fill="white">Y = X ⊗ Att_h ⊗ Att_w</text>
</g>
<!-- feat_input&#45;&gt;fusion -->
<g id="edge29" class="edge">
<title>feat_input&#45;&gt;fusion</title>
<path fill="none" stroke="#f39c12" d="M163.76,-184.34C194.52,-197.19 240.18,-214.1 282,-221.07 311.74,-226.03 717.04,-217.07 748.14,-217.07 748.14,-217.07 748.14,-217.07 1030.72,-217.07 1050.84,-217.07 1056.2,-216.98 1075.72,-212.07 1097.63,-206.56 1120.81,-198.03 1141.15,-189.57"/>
<polygon fill="#f39c12" stroke="#f39c12" points="1142.74,-192.7 1150.58,-185.57 1140.01,-186.25 1142.74,-192.7"/>
<text text-anchor="middle" x="653.14" y="-221.87" font-family="Arial" font-size="9.00">⊗</text>
</g>
<!-- feat_h -->
<g id="node14" class="node">
<title>feat_h</title>
<polygon fill="#e74c3c" stroke="black" points="466.5,-126.07 412.5,-126.07 412.5,-90.07 466.5,-90.07 466.5,-126.07"/>
<text text-anchor="middle" x="439.5" y="-111.07" font-family="Arial" font-size="10.00" fill="white">X_h</text>
<text text-anchor="middle" x="439.5" y="-100.07" font-family="Arial" font-size="10.00" fill="white">[H,1,C]</text>
</g>
<!-- pool_h&#45;&gt;feat_h -->
<g id="edge17" class="edge">
<title>pool_h&#45;&gt;feat_h</title>
<path fill="none" stroke="black" d="M358.3,-108.07C371.9,-108.07 387.87,-108.07 401.96,-108.07"/>
<polygon fill="black" stroke="black" points="402.29,-111.57 412.29,-108.07 402.29,-104.57 402.29,-111.57"/>
</g>
<!-- feat_w -->
<g id="node15" class="node">
<title>feat_w</title>
<polygon fill="#e74c3c" stroke="black" points="466.5,-183.07 412.5,-183.07 412.5,-147.07 466.5,-147.07 466.5,-183.07"/>
<text text-anchor="middle" x="439.5" y="-168.07" font-family="Arial" font-size="10.00" fill="white">X_w</text>
<text text-anchor="middle" x="439.5" y="-157.07" font-family="Arial" font-size="10.00" fill="white">[1,W,C]</text>
</g>
<!-- pool_w&#45;&gt;feat_w -->
<g id="edge18" class="edge">
<title>pool_w&#45;&gt;feat_w</title>
<path fill="none" stroke="black" d="M357.4,-167.24C371.26,-166.87 387.71,-166.43 402.15,-166.05"/>
<polygon fill="black" stroke="black" points="402.35,-169.54 412.25,-165.77 402.16,-162.54 402.35,-169.54"/>
</g>
<!-- conv_transform -->
<g id="node16" class="node">
<title>conv_transform</title>
<polygon fill="#27ae60" stroke="black" points="612.07,-128.57 537.07,-128.57 537.07,-87.57 612.07,-87.57 612.07,-128.57"/>
<text text-anchor="middle" x="574.57" y="-116.57" font-family="Arial" font-size="10.00" fill="white">Conv1×1</text>
<text text-anchor="middle" x="574.57" y="-105.57" font-family="Arial" font-size="10.00" fill="white">+ BatchNorm</text>
<text text-anchor="middle" x="574.57" y="-94.57" font-family="Arial" font-size="10.00" fill="white">+ ReLU</text>
</g>
<!-- feat_h&#45;&gt;conv_transform -->
<g id="edge19" class="edge">
<title>feat_h&#45;&gt;conv_transform</title>
<path fill="none" stroke="black" d="M466.79,-108.07C483.88,-108.07 506.65,-108.07 526.77,-108.07"/>
<polygon fill="black" stroke="black" points="527.01,-111.57 537.01,-108.07 527.01,-104.57 527.01,-111.57"/>
</g>
<!-- feat_w&#45;&gt;conv_transform -->
<g id="edge20" class="edge">
<title>feat_w&#45;&gt;conv_transform</title>
<path fill="none" stroke="black" d="M466.79,-153.81C484.12,-146.39 507.28,-136.47 527.6,-127.76"/>
<polygon fill="black" stroke="black" points="529.19,-130.89 537.01,-123.73 526.44,-124.45 529.19,-130.89"/>
</g>
<!-- conv_h -->
<g id="node17" class="node">
<title>conv_h</title>
<polygon fill="#9b59b6" stroke="black" points="776.14,-126.07 722.14,-126.07 722.14,-90.07 776.14,-90.07 776.14,-126.07"/>
<text text-anchor="middle" x="749.14" y="-105.57" font-family="Arial" font-size="10.00" fill="white">Conv_h</text>
</g>
<!-- conv_transform&#45;&gt;conv_h -->
<g id="edge21" class="edge">
<title>conv_transform&#45;&gt;conv_h</title>
<path fill="none" stroke="black" d="M612.17,-108.07C641.51,-108.07 682.48,-108.07 711.76,-108.07"/>
<polygon fill="black" stroke="black" points="711.98,-111.57 721.98,-108.07 711.98,-104.57 711.98,-111.57"/>
</g>
<!-- conv_w -->
<g id="node18" class="node">
<title>conv_w</title>
<polygon fill="#9b59b6" stroke="black" points="776.14,-180.07 722.14,-180.07 722.14,-144.07 776.14,-144.07 776.14,-180.07"/>
<text text-anchor="middle" x="749.14" y="-159.57" font-family="Arial" font-size="10.00" fill="white">Conv_w</text>
</g>
<!-- conv_transform&#45;&gt;conv_w -->
<g id="edge22" class="edge">
<title>conv_transform&#45;&gt;conv_w</title>
<path fill="none" stroke="black" d="M612.17,-119.52C641.64,-128.75 682.84,-141.64 712.15,-150.81"/>
<polygon fill="black" stroke="black" points="711.39,-154.24 721.98,-153.89 713.48,-147.56 711.39,-154.24"/>
</g>
<!-- sigmoid_h -->
<g id="node19" class="node">
<title>sigmoid_h</title>
<polygon fill="#8e44ad" stroke="black" points="907.43,-126.07 864.35,-108.07 907.43,-90.07 950.51,-108.07 907.43,-126.07"/>
<text text-anchor="middle" x="907.43" y="-105.57" font-family="Arial" font-size="10.00" fill="white">Sigmoid</text>
</g>
<!-- conv_h&#45;&gt;sigmoid_h -->
<g id="edge23" class="edge">
<title>conv_h&#45;&gt;sigmoid_h</title>
<path fill="none" stroke="black" d="M776.3,-108.07C797.47,-108.07 827.96,-108.07 854.11,-108.07"/>
<polygon fill="black" stroke="black" points="854.26,-111.57 864.26,-108.07 854.26,-104.57 854.26,-111.57"/>
</g>
<!-- sigmoid_w -->
<g id="node20" class="node">
<title>sigmoid_w</title>
<polygon fill="#8e44ad" stroke="black" points="907.43,-180.07 864.35,-162.07 907.43,-144.07 950.51,-162.07 907.43,-180.07"/>
<text text-anchor="middle" x="907.43" y="-159.57" font-family="Arial" font-size="10.00" fill="white">Sigmoid</text>
</g>
<!-- conv_w&#45;&gt;sigmoid_w -->
<g id="edge24" class="edge">
<title>conv_w&#45;&gt;sigmoid_w</title>
<path fill="none" stroke="black" d="M776.3,-162.07C797.47,-162.07 827.96,-162.07 854.11,-162.07"/>
<polygon fill="black" stroke="black" points="854.26,-165.57 864.26,-162.07 854.26,-158.57 854.26,-165.57"/>
</g>
<!-- attn_h -->
<g id="node21" class="node">
<title>attn_h</title>
<polygon fill="#e67e22" stroke="black" points="1056.72,-126.07 1002.72,-126.07 1002.72,-90.07 1056.72,-90.07 1056.72,-126.07"/>
<text text-anchor="middle" x="1029.72" y="-111.07" font-family="Arial" font-size="10.00" fill="white">Att_h</text>
<text text-anchor="middle" x="1029.72" y="-100.07" font-family="Arial" font-size="10.00" fill="white">[H,1,C]</text>
</g>
<!-- sigmoid_h&#45;&gt;attn_h -->
<g id="edge25" class="edge">
<title>sigmoid_h&#45;&gt;attn_h</title>
<path fill="none" stroke="black" d="M950.84,-108.07C964.39,-108.07 979.27,-108.07 992.36,-108.07"/>
<polygon fill="black" stroke="black" points="992.41,-111.57 1002.41,-108.07 992.41,-104.57 992.41,-111.57"/>
</g>
<!-- attn_w -->
<g id="node22" class="node">
<title>attn_w</title>
<polygon fill="#e67e22" stroke="black" points="1056.72,-180.07 1002.72,-180.07 1002.72,-144.07 1056.72,-144.07 1056.72,-180.07"/>
<text text-anchor="middle" x="1029.72" y="-165.07" font-family="Arial" font-size="10.00" fill="white">Att_w</text>
<text text-anchor="middle" x="1029.72" y="-154.07" font-family="Arial" font-size="10.00" fill="white">[1,W,C]</text>
</g>
<!-- sigmoid_w&#45;&gt;attn_w -->
<g id="edge26" class="edge">
<title>sigmoid_w&#45;&gt;attn_w</title>
<path fill="none" stroke="black" d="M950.84,-162.07C964.39,-162.07 979.27,-162.07 992.36,-162.07"/>
<polygon fill="black" stroke="black" points="992.41,-165.57 1002.41,-162.07 992.41,-158.57 992.41,-165.57"/>
</g>
<!-- attn_h&#45;&gt;fusion -->
<g id="edge27" class="edge">
<title>attn_h&#45;&gt;fusion</title>
<path fill="none" stroke="black" d="M1056.81,-116.39C1076.8,-122.77 1105.35,-131.87 1131.71,-140.27"/>
<polygon fill="black" stroke="black" points="1130.71,-143.63 1141.3,-143.33 1132.83,-136.96 1130.71,-143.63"/>
</g>
<!-- attn_w&#45;&gt;fusion -->
<g id="edge28" class="edge">
<title>attn_w&#45;&gt;fusion</title>
<path fill="none" stroke="black" d="M1056.81,-162.07C1067.48,-162.07 1080.6,-162.07 1094.51,-162.07"/>
<polygon fill="black" stroke="black" points="1094.76,-165.57 1104.76,-162.07 1094.76,-158.57 1094.76,-165.57"/>
</g>
<!-- output_feat -->
<g id="node24" class="node">
<title>output_feat</title>
<polygon fill="#1abc9c" stroke="black" points="1449.91,-180.07 1389.91,-180.07 1389.91,-144.07 1449.91,-144.07 1449.91,-180.07"/>
<text text-anchor="middle" x="1419.91" y="-165.07" font-family="Arial" font-size="10.00" fill="white">Enhanced</text>
<text text-anchor="middle" x="1419.91" y="-154.07" font-family="Arial" font-size="10.00" fill="white">Feature</text>
</g>
<!-- fusion&#45;&gt;output_feat -->
<g id="edge30" class="edge">
<title>fusion&#45;&gt;output_feat</title>
<path fill="none" stroke="black" d="M1297.49,-162.07C1326.46,-162.07 1356.69,-162.07 1379.73,-162.07"/>
<polygon fill="black" stroke="black" points="1379.79,-165.57 1389.79,-162.07 1379.79,-158.57 1379.79,-165.57"/>
</g>
<!-- dcb -->
<g id="node26" class="node">
<title>dcb</title>
<polygon fill="#e74c3c" stroke="black" points="352.5,-340.07 298.5,-340.07 298.5,-304.07 352.5,-304.07 352.5,-340.07"/>
<text text-anchor="middle" x="325.5" y="-325.07" font-family="Arial" font-size="10.00" fill="white">DCB</text>
<text text-anchor="middle" x="325.5" y="-314.07" font-family="Arial" font-size="10.00" fill="white">(3×3)</text>
</g>
<!-- det_input&#45;&gt;dcb -->
<g id="edge31" class="edge">
<title>det_input&#45;&gt;dcb</title>
<path fill="none" stroke="black" d="M158.72,-367.52C194.02,-357.84 251.41,-342.11 288.56,-331.92"/>
<polygon fill="black" stroke="black" points="289.74,-335.23 298.46,-329.21 287.89,-328.48 289.74,-335.23"/>
</g>
<!-- dcbr -->
<g id="node27" class="node">
<title>dcbr</title>
<polygon fill="#c0392b" stroke="black" points="352.5,-394.07 298.5,-394.07 298.5,-358.07 352.5,-358.07 352.5,-394.07"/>
<text text-anchor="middle" x="325.5" y="-379.07" font-family="Arial" font-size="10.00" fill="white">DCBR</text>
<text text-anchor="middle" x="325.5" y="-368.07" font-family="Arial" font-size="10.00" fill="white">(5×5)</text>
</g>
<!-- det_input&#45;&gt;dcbr -->
<g id="edge32" class="edge">
<title>det_input&#45;&gt;dcbr</title>
<path fill="none" stroke="black" d="M158.72,-376.07C193.87,-376.07 250.92,-376.07 288.08,-376.07"/>
<polygon fill="black" stroke="black" points="288.46,-379.57 298.46,-376.07 288.46,-372.57 288.46,-379.57"/>
</g>
<!-- conv7 -->
<g id="node28" class="node">
<title>conv7</title>
<polygon fill="#e74c3c" stroke="black" points="352.5,-448.07 298.5,-448.07 298.5,-412.07 352.5,-412.07 352.5,-448.07"/>
<text text-anchor="middle" x="325.5" y="-433.07" font-family="Arial" font-size="10.00" fill="white">Conv</text>
<text text-anchor="middle" x="325.5" y="-422.07" font-family="Arial" font-size="10.00" fill="white">(7×7)</text>
</g>
<!-- det_input&#45;&gt;conv7 -->
<g id="edge33" class="edge">
<title>det_input&#45;&gt;conv7</title>
<path fill="none" stroke="black" d="M158.72,-384.63C194.02,-394.31 251.41,-410.04 288.56,-420.22"/>
<polygon fill="black" stroke="black" points="287.89,-423.67 298.46,-422.93 289.74,-416.92 287.89,-423.67"/>
</g>
<!-- concat_context -->
<g id="node29" class="node">
<title>concat_context</title>
<polygon fill="#d35400" stroke="black" points="439.5,-394.07 399.58,-376.07 439.5,-358.07 479.42,-376.07 439.5,-394.07"/>
<text text-anchor="middle" x="439.5" y="-373.57" font-family="Arial" font-size="10.00" fill="white">Concat</text>
</g>
<!-- dcb&#45;&gt;concat_context -->
<g id="edge34" class="edge">
<title>dcb&#45;&gt;concat_context</title>
<path fill="none" stroke="black" d="M352.76,-334.73C370,-343.04 392.53,-353.91 410.18,-362.41"/>
<polygon fill="black" stroke="black" points="408.88,-365.68 419.41,-366.87 411.92,-359.37 408.88,-365.68"/>
</g>
<!-- dcbr&#45;&gt;concat_context -->
<g id="edge35" class="edge">
<title>dcbr&#45;&gt;concat_context</title>
<path fill="none" stroke="black" d="M352.76,-376.07C363.57,-376.07 376.46,-376.07 388.92,-376.07"/>
<polygon fill="black" stroke="black" points="389.24,-379.57 399.24,-376.07 389.24,-372.57 389.24,-379.57"/>
</g>
<!-- conv7&#45;&gt;concat_context -->
<g id="edge36" class="edge">
<title>conv7&#45;&gt;concat_context</title>
<path fill="none" stroke="black" d="M352.76,-417.41C370,-409.1 392.53,-398.23 410.18,-389.73"/>
<polygon fill="black" stroke="black" points="411.92,-392.77 419.41,-385.28 408.88,-386.47 411.92,-392.77"/>
</g>
<!-- relu_context -->
<g id="node30" class="node">
<title>relu_context</title>
<polygon fill="#e67e22" stroke="black" points="574.57,-394.07 539.64,-376.07 574.57,-358.07 609.5,-376.07 574.57,-394.07"/>
<text text-anchor="middle" x="574.57" y="-373.57" font-family="Arial" font-size="10.00" fill="white">ReLU</text>
</g>
<!-- concat_context&#45;&gt;relu_context -->
<g id="edge37" class="edge">
<title>concat_context&#45;&gt;relu_context</title>
<path fill="none" stroke="black" d="M479.71,-376.07C495.3,-376.07 513.32,-376.07 529.38,-376.07"/>
<polygon fill="black" stroke="black" points="529.6,-379.57 539.6,-376.07 529.6,-372.57 529.6,-379.57"/>
</g>
<!-- channel_shuffle -->
<g id="node31" class="node">
<title>channel_shuffle</title>
<ellipse fill="#16a085" stroke="black" cx="749.14" cy="-376.07" rx="37.45" ry="21.43"/>
<text text-anchor="middle" x="749.14" y="-379.07" font-family="Arial" font-size="10.00" fill="white">Channel</text>
<text text-anchor="middle" x="749.14" y="-368.07" font-family="Arial" font-size="10.00" fill="white">Shuffle</text>
</g>
<!-- relu_context&#45;&gt;channel_shuffle -->
<g id="edge38" class="edge">
<title>relu_context&#45;&gt;channel_shuffle</title>
<path fill="none" stroke="black" d="M609.66,-376.07C635.82,-376.07 672.23,-376.07 701.15,-376.07"/>
<polygon fill="black" stroke="black" points="701.43,-379.57 711.43,-376.07 701.43,-372.57 701.43,-379.57"/>
</g>
<!-- conv_bbox -->
<g id="node32" class="node">
<title>conv_bbox</title>
<polygon fill="#1abc9c" stroke="black" points="934.43,-340.07 880.43,-340.07 880.43,-304.07 934.43,-304.07 934.43,-340.07"/>
<text text-anchor="middle" x="907.43" y="-325.07" font-family="Arial" font-size="10.00" fill="white">Conv</text>
<text text-anchor="middle" x="907.43" y="-314.07" font-family="Arial" font-size="10.00" fill="white">BBox</text>
</g>
<!-- channel_shuffle&#45;&gt;conv_bbox -->
<g id="edge39" class="edge">
<title>channel_shuffle&#45;&gt;conv_bbox</title>
<path fill="none" stroke="black" d="M781.76,-365.14C807.47,-356.26 843.73,-343.73 870.52,-334.48"/>
<polygon fill="black" stroke="black" points="871.98,-337.68 880.29,-331.1 869.69,-331.06 871.98,-337.68"/>
</g>
<!-- conv_cls -->
<g id="node33" class="node">
<title>conv_cls</title>
<polygon fill="#1abc9c" stroke="black" points="934.43,-394.07 880.43,-394.07 880.43,-358.07 934.43,-358.07 934.43,-394.07"/>
<text text-anchor="middle" x="907.43" y="-379.07" font-family="Arial" font-size="10.00" fill="white">Conv</text>
<text text-anchor="middle" x="907.43" y="-368.07" font-family="Arial" font-size="10.00" fill="white">Cls</text>
</g>
<!-- channel_shuffle&#45;&gt;conv_cls -->
<g id="edge40" class="edge">
<title>channel_shuffle&#45;&gt;conv_cls</title>
<path fill="none" stroke="black" d="M786.78,-376.07C811.88,-376.07 845.04,-376.07 870.08,-376.07"/>
<polygon fill="black" stroke="black" points="870.27,-379.57 880.27,-376.07 870.27,-372.57 870.27,-379.57"/>
</g>
<!-- conv_landmark -->
<g id="node34" class="node">
<title>conv_landmark</title>
<polygon fill="#1abc9c" stroke="black" points="936.93,-448.07 877.93,-448.07 877.93,-412.07 936.93,-412.07 936.93,-448.07"/>
<text text-anchor="middle" x="907.43" y="-433.07" font-family="Arial" font-size="10.00" fill="white">Conv</text>
<text text-anchor="middle" x="907.43" y="-422.07" font-family="Arial" font-size="10.00" fill="white">Landmark</text>
</g>
<!-- channel_shuffle&#45;&gt;conv_landmark -->
<g id="edge41" class="edge">
<title>channel_shuffle&#45;&gt;conv_landmark</title>
<path fill="none" stroke="black" d="M781.76,-387C806.68,-395.61 841.51,-407.64 868.02,-416.8"/>
<polygon fill="black" stroke="black" points="867.15,-420.2 877.74,-420.16 869.43,-413.59 867.15,-420.2"/>
</g>
<!-- bbox_out -->
<g id="node35" class="node">
<title>bbox_out</title>
<polygon fill="#34495e" stroke="black" points="1062.72,-340.07 996.72,-340.07 996.72,-304.07 1062.72,-304.07 1062.72,-340.07"/>
<text text-anchor="middle" x="1029.72" y="-325.07" font-family="Arial" font-size="10.00" fill="white">BBox</text>
<text text-anchor="middle" x="1029.72" y="-314.07" font-family="Arial" font-size="10.00" fill="white">Regression</text>
</g>
<!-- conv_bbox&#45;&gt;bbox_out -->
<g id="edge42" class="edge">
<title>conv_bbox&#45;&gt;bbox_out</title>
<path fill="none" stroke="black" d="M934.53,-322.07C949.63,-322.07 969.01,-322.07 986.26,-322.07"/>
<polygon fill="black" stroke="black" points="986.67,-325.57 996.67,-322.07 986.67,-318.57 986.67,-325.57"/>
</g>
<!-- cls_out -->
<g id="node36" class="node">
<title>cls_out</title>
<polygon fill="#34495e" stroke="black" points="1067.72,-394.07 991.72,-394.07 991.72,-358.07 1067.72,-358.07 1067.72,-394.07"/>
<text text-anchor="middle" x="1029.72" y="-373.57" font-family="Arial" font-size="10.00" fill="white">Classification</text>
</g>
<!-- conv_cls&#45;&gt;cls_out -->
<g id="edge43" class="edge">
<title>conv_cls&#45;&gt;cls_out</title>
<path fill="none" stroke="black" d="M934.53,-376.07C948.24,-376.07 965.48,-376.07 981.45,-376.07"/>
<polygon fill="black" stroke="black" points="981.71,-379.57 991.71,-376.07 981.71,-372.57 981.71,-379.57"/>
</g>
<!-- landmark_out -->
<g id="node37" class="node">
<title>landmark_out</title>
<polygon fill="#34495e" stroke="black" points="1062.72,-448.07 996.72,-448.07 996.72,-412.07 1062.72,-412.07 1062.72,-448.07"/>
<text text-anchor="middle" x="1029.72" y="-433.07" font-family="Arial" font-size="10.00" fill="white">Landmark</text>
<text text-anchor="middle" x="1029.72" y="-422.07" font-family="Arial" font-size="10.00" fill="white">Regression</text>
</g>
<!-- conv_landmark&#45;&gt;landmark_out -->
<g id="edge44" class="edge">
<title>conv_landmark&#45;&gt;landmark_out</title>
<path fill="none" stroke="black" d="M936.93,-430.07C951.64,-430.07 969.87,-430.07 986.2,-430.07"/>
<polygon fill="black" stroke="black" points="986.6,-433.57 996.6,-430.07 986.6,-426.57 986.6,-433.57"/>
</g>
</g>
</svg>
