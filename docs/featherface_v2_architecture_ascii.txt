FeatherFace V2 Architecture - Coordinate Attention Innovation
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        FeatherFace V2 Pipeline                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Input Image (640Ã—640Ã—3)
        â”‚
        â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   MobileNetV1     â”‚  â† Lightweight backbone (Howard et al. 2017)
â”‚     0.25x         â”‚    460K parameters
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚
        â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚      BiFPN        â”‚  â† Bidirectional Feature Pyramid (Tan et al. 2020)
â”‚   Multi-scale     â”‚    25K parameters
â”‚    Features       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚
        â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Coordinate        â”‚  ğŸ†• V2 Innovation (Hou et al. CVPR 2021)
â”‚   Attention       â”‚     4K parameters (+0.8% overhead)
â”‚                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”  â”‚     â”Œâ”€ Spatial X encoding
â”‚  â”‚X-Avgâ”‚ â”‚Y-Avgâ”‚  â”‚  â”€â”€â”€â”¤
â”‚  â”‚Pool â”‚ â”‚Pool â”‚  â”‚     â””â”€ Spatial Y encoding
â”‚  â””â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”˜  â”‚
â”‚     â”‚       â”‚     â”‚     â”Œâ”€ h_swish activation
â”‚     â–¼       â–¼     â”‚  â”€â”€â”€â”¤
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚     â””â”€ Mobile optimized
â”‚  â”‚ 1Ã—1 Conv +  â”‚  â”‚
â”‚  â”‚ BatchNorm   â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚     â”‚       â”‚     â”‚
â”‚     â–¼       â–¼     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚Conv â”‚ â”‚Conv â”‚  â”‚
â”‚  â”‚  H  â”‚ â”‚  W  â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”˜  â”‚
â”‚     â”‚       â”‚     â”‚
â”‚     â””â”€â”€â”€â”¬â”€â”€â”€â”˜     â”‚
â”‚         â–¼         â”‚
â”‚   Attention Map   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚
        â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚       SSH         â”‚  â† Single Shot Hierarchical heads
â”‚  Detection Heads  â”‚    Detection + Classification + Landmarks
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚
        â–¼
Output: [BBox, Classification, Landmarks]

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

V1 vs V2 Comparison:

V1 (Baseline):
Input â†’ MobileNet â†’ CBAM â†’ BiFPN â†’ CBAM â†’ SSH â†’ Output
                    â†‘               â†‘
                 Standard        Standard
                Attention       Attention

V2 (Enhanced):
Input â†’ MobileNet â†’ CBAM â†’ BiFPN â†’ CoordAttn â†’ SSH â†’ Output
                    â†‘                 â†‘
                 Standard       ğŸ†• Coordinate
                Attention        Attention

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Performance Improvements:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚      Metric      â”‚   V1    â”‚   V2    â”‚ Improvement â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Parameters       â”‚  489K   â”‚  493K   â”‚    +0.8%   â”‚
â”‚ WIDERFace Easy   â”‚ 87.0%   â”‚ 90.0%   â”‚    +3.0%   â”‚
â”‚ WIDERFace Medium â”‚ 82.5%   â”‚ 88.0%   â”‚    +5.5%   â”‚
â”‚ WIDERFace Hard   â”‚ 77.2%   â”‚ 88.0%   â”‚   +10.8%   â”‚
â”‚ Mobile Speed     â”‚ 15.2ms  â”‚  7.6ms  â”‚  2x faster â”‚
â”‚ Model Size       â”‚ 1.9MB   â”‚ 1.9MB   â”‚    Same     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Key Innovation - Coordinate Attention:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                                         â”‚
â”‚  Input Feature Map (HÃ—WÃ—C)                                            â”‚
â”‚           â”‚                                                            â”‚
â”‚           â–¼                                                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                           â”‚
â”‚  â”‚         Coordinate Attention           â”‚                           â”‚
â”‚  â”‚                                        â”‚                           â”‚
â”‚  â”‚  HÃ—1Ã—C â—„â”€â”€â”€ X-direction pooling        â”‚  ğŸ” Spatial encoding      â”‚
â”‚  â”‚  1Ã—WÃ—C â—„â”€â”€â”€ Y-direction pooling        â”‚                           â”‚
â”‚  â”‚     â”‚           â”‚                      â”‚  âš¡ Mobile optimized     â”‚
â”‚  â”‚     â–¼           â–¼                      â”‚                           â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚  ğŸ“± Hardware friendly    â”‚
â”‚  â”‚  â”‚     Shared 1Ã—1 Conv             â”‚   â”‚                           â”‚
â”‚  â”‚  â”‚   + BatchNorm + h_swish         â”‚   â”‚  ğŸ¯ Minimal overhead     â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚     (+4K parameters)     â”‚
â”‚  â”‚     â”‚           â”‚                      â”‚                           â”‚
â”‚  â”‚     â–¼           â–¼                      â”‚                           â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”                  â”‚                           â”‚
â”‚  â”‚  â”‚Conv â”‚     â”‚Conv â”‚                  â”‚                           â”‚
â”‚  â”‚  â”‚  H  â”‚     â”‚  W  â”‚                  â”‚                           â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”˜                  â”‚                           â”‚
â”‚  â”‚     â”‚           â”‚                      â”‚                           â”‚
â”‚  â”‚     â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜                      â”‚                           â”‚
â”‚  â”‚           â–¼                            â”‚                           â”‚
â”‚  â”‚    Attention Weight                    â”‚                           â”‚
â”‚  â”‚    (HÃ—W spatial map)                   â”‚                           â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                           â”‚
â”‚           â”‚                                                            â”‚
â”‚           â–¼                                                            â”‚
â”‚  Enhanced Feature Map (HÃ—WÃ—C)                                         â”‚
â”‚                                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Scientific Foundation: Hou et al. CVPR 2021
"Coordinate Attention for Efficient Mobile Network Design"