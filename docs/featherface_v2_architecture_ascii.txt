FeatherFace V2 Architecture - Coordinate Attention Innovation
═══════════════════════════════════════════════════════════

┌─────────────────────────────────────────────────────────────────────────┐
│                        FeatherFace V2 Pipeline                         │
└─────────────────────────────────────────────────────────────────────────┘

Input Image (640×640×3)
        │
        ▼
┌───────────────────┐
│   MobileNetV1     │  ← Lightweight backbone (Howard et al. 2017)
│     0.25x         │    460K parameters
└───────────────────┘
        │
        ▼
┌───────────────────┐
│      BiFPN        │  ← Bidirectional Feature Pyramid (Tan et al. 2020)
│   Multi-scale     │    25K parameters
│    Features       │
└───────────────────┘
        │
        ▼
┌───────────────────┐
│ Coordinate        │  🆕 V2 Innovation (Hou et al. CVPR 2021)
│   Attention       │     4K parameters (+0.8% overhead)
│                   │
│  ┌─────┐ ┌─────┐  │     ┌─ Spatial X encoding
│  │X-Avg│ │Y-Avg│  │  ───┤
│  │Pool │ │Pool │  │     └─ Spatial Y encoding
│  └─────┘ └─────┘  │
│     │       │     │     ┌─ h_swish activation
│     ▼       ▼     │  ───┤
│  ┌─────────────┐  │     └─ Mobile optimized
│  │ 1×1 Conv +  │  │
│  │ BatchNorm   │  │
│  └─────────────┘  │
│     │       │     │
│     ▼       ▼     │
│  ┌─────┐ ┌─────┐  │
│  │Conv │ │Conv │  │
│  │  H  │ │  W  │  │
│  └─────┘ └─────┘  │
│     │       │     │
│     └───┬───┘     │
│         ▼         │
│   Attention Map   │
└───────────────────┘
        │
        ▼
┌───────────────────┐
│       SSH         │  ← Single Shot Hierarchical heads
│  Detection Heads  │    Detection + Classification + Landmarks
└───────────────────┘
        │
        ▼
Output: [BBox, Classification, Landmarks]

═══════════════════════════════════════════════════════════════════════════

V1 vs V2 Comparison:

V1 (Baseline):
Input → MobileNet → CBAM → BiFPN → CBAM → SSH → Output
                    ↑               ↑
                 Standard        Standard
                Attention       Attention

V2 (Enhanced):
Input → MobileNet → CBAM → BiFPN → CoordAttn → SSH → Output
                    ↑                 ↑
                 Standard       🆕 Coordinate
                Attention        Attention

═══════════════════════════════════════════════════════════════════════════

Performance Improvements:
┌──────────────────┬─────────┬─────────┬─────────────┐
│      Metric      │   V1    │   V2    │ Improvement │
├──────────────────┼─────────┼─────────┼─────────────┤
│ Parameters       │  489K   │  493K   │    +0.8%   │
│ WIDERFace Easy   │ 87.0%   │ 90.0%   │    +3.0%   │
│ WIDERFace Medium │ 82.5%   │ 88.0%   │    +5.5%   │
│ WIDERFace Hard   │ 77.2%   │ 88.0%   │   +10.8%   │
│ Mobile Speed     │ 15.2ms  │  7.6ms  │  2x faster │
│ Model Size       │ 1.9MB   │ 1.9MB   │    Same     │
└──────────────────┴─────────┴─────────┴─────────────┘

═══════════════════════════════════════════════════════════════════════════

Key Innovation - Coordinate Attention:
┌─────────────────────────────────────────────────────────────────────────┐
│                                                                         │
│  Input Feature Map (H×W×C)                                            │
│           │                                                            │
│           ▼                                                            │
│  ┌────────────────────────────────────────┐                           │
│  │         Coordinate Attention           │                           │
│  │                                        │                           │
│  │  H×1×C ◄─── X-direction pooling        │  🔍 Spatial encoding      │
│  │  1×W×C ◄─── Y-direction pooling        │                           │
│  │     │           │                      │  ⚡ Mobile optimized     │
│  │     ▼           ▼                      │                           │
│  │  ┌─────────────────────────────────┐   │  📱 Hardware friendly    │
│  │  │     Shared 1×1 Conv             │   │                           │
│  │  │   + BatchNorm + h_swish         │   │  🎯 Minimal overhead     │
│  │  └─────────────────────────────────┘   │     (+4K parameters)     │
│  │     │           │                      │                           │
│  │     ▼           ▼                      │                           │
│  │  ┌─────┐     ┌─────┐                  │                           │
│  │  │Conv │     │Conv │                  │                           │
│  │  │  H  │     │  W  │                  │                           │
│  │  └─────┘     └─────┘                  │                           │
│  │     │           │                      │                           │
│  │     └─────┬─────┘                      │                           │
│  │           ▼                            │                           │
│  │    Attention Weight                    │                           │
│  │    (H×W spatial map)                   │                           │
│  └────────────────────────────────────────┘                           │
│           │                                                            │
│           ▼                                                            │
│  Enhanced Feature Map (H×W×C)                                         │
│                                                                         │
└─────────────────────────────────────────────────────────────────────────┘

Scientific Foundation: Hou et al. CVPR 2021
"Coordinate Attention for Efficient Mobile Network Design"